name: Make book files
on: [push]

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
          
      - name: Install dependencies 
        run: |
           'npm install graceful-fs@latest --save'
           'npm i -g gitbook-cli'
           'choco install calibre --version 5.44.0'
           'refreshenv'
           'npm i -g svgexport@0.4.2'
           
      - name: Install GitBook
        run: |
           'if exist _book rd /Q /S _book'
           'gitbook install'
           'gitbook build'
           
      - name: Make regular book files
        run: |
           'mkdir ~/book'
           'gitbook pdf ./ ~/book/juice-shop.pdf'
           'gitbook mobi ./ ~/book/juice-shop.mobi'
           'gitbook epub ./ ~/book/juice-shop.epub'
      
      - name: Archive book files
        uses: actions/upload-artifact@v3
        with:
          name: book
          path: |
            ~/book/*
